# C盘清理工具 (Python增强版) 操作手册

## 1. 工具简介

本工具是一个使用 Python 编写的脚本，旨在帮助用户清理 Windows 系统 C 盘上常见的临时文件和缓存，以释放磁盘空间。它会自动执行以下操作：

*   清理系统和当前用户的临时文件夹。
*   清理 Windows 更新下载的缓存文件。
*   清空回收站。
*   启动 Windows 自带的磁盘清理工具，让您可以选择更多清理选项。

脚本提供了中文界面和详细的操作步骤提示。

## 2. 使用前准备

在运行此工具前，请确保满足以下条件：

1.  **安装 Python 环境：** 您的电脑需要安装 Python 3.x 版本。如果您尚未安装，请前往 [Python 官方网站](https://www.python.org/downloads/) 下载并安装最新稳定版本。在安装过程中，**请务必勾选 "Add Python to PATH"** 或类似的选项，以便在命令行中直接运行 `python` 命令。
2.  **获取脚本文件：** 您需要拥有以下两个文件，并将它们放在 **同一个文件夹** 下：
    *   `CleanC_v2_EnhancedUI.py` (主要的 Python 清理脚本)
    *   `Run_CleanC_Python_v2.bat` (用于启动 Python 脚本的批处理文件)

## 3. 如何运行工具

请严格按照以下步骤操作，以确保工具正常运行：

1.  **找到启动文件：** 打开存放 `CleanC_v2_EnhancedUI.py` 和 `Run_CleanC_Python_v2.bat` 的文件夹。
2.  **右键点击批处理文件：** 找到 `Run_CleanC_Python_v2.bat` 文件。
3.  **选择"以管理员身份运行"：** 在右键菜单中，点击 **"以管理员身份运行"**。
    *   **非常重要：** 必须以管理员权限运行，否则脚本将无法清理系统级文件或停止/启动系统服务，导致清理失败或效果不佳。
4.  **用户账户控制 (UAC) 提示：** 如果系统弹出用户账户控制窗口，询问是否允许此应用对您的设备进行更改，请点击 **"是"**。
5.  **脚本开始运行：** 一个黑色的命令提示符窗口将会打开，并显示脚本的欢迎界面和初始化信息。
6.  **按照提示操作：**
    *   脚本会自动执行前三个清理步骤（临时文件、更新缓存、回收站），并显示进度或状态信息。
    *   当进行到第 4 步时，脚本会提示您按 Enter 键以启动 Windows 磁盘清理工具。
    *   按下 Enter 键后，Windows 自带的磁盘清理工具会弹出。
    *   在磁盘清理工具窗口中，**手动勾选** 您希望清理的项目（例如：传递优化文件、以前的 Windows 安装、系统错误内存转储文件等）。
    *   勾选完毕后，点击磁盘清理工具窗口右下角的 **"确定"** 按钮。
    *   磁盘清理工具会开始执行您选择的清理任务，这可能需要一些时间。
7.  **脚本结束：** 当 Python 脚本启动磁盘清理工具后，它会在命令提示符窗口中显示"所有清理操作已启动/完成"的信息。此时，您可以等待 Windows 磁盘清理工具自行完成（如果它仍在后台运行），然后按 Enter 键关闭命令提示符窗口。

## 4. 注意事项

*   **文件编码：** Python 脚本 (`.py`) 文件应保存为 **UTF-8** 编码。批处理启动器 (`.bat`) 文件应保存为 **ANSI** 或 **GBK (代码页 936)** 编码，以确保中文在命令提示符中正确显示。
*   **管理员权限：** 重复强调，**必须** 以管理员身份运行启动器 (`.bat` 文件)。
*   **磁盘清理工具：** 脚本会自动清理前三项，但 Windows 磁盘清理工具 (`cleanmgr.exe`) 需要您 **手动选择并确认** 要清理的项目。
*   **杀毒软件：** 某些杀毒软件可能会对修改系统文件或停止/启动系统服务的脚本行为产生警告。如果遇到这种情况，请根据您对脚本来源的信任程度自行判断是否允许其操作。

## 5. 常见问题与解决

*   **错误：未找到 Python 环境！**
    *   **原因：** 没有安装 Python，或者安装时未将其添加到系统 PATH 环境变量。
    *   **解决：** 访问 python.org 下载并安装 Python，确保安装时勾选 "Add Python to PATH"。如果已安装但未添加 PATH，需要手动将 Python 的安装路径添加到系统环境变量中。
*   **错误：请以管理员身份运行此脚本！**
    *   **原因：** 没有右键点击 `.bat` 文件并选择"以管理员身份运行"。
    *   **解决：** 关闭窗口，右键点击 `Run_CleanC_Python_v2.bat`，选择"以管理员身份运行"。
*   **中文显示乱码：**
    *   **原因：** `.bat` 文件保存编码不正确，或命令提示符字体不支持中文。
    *   **解决：**
        1.  使用记事本或其他编辑器打开 `.bat` 文件，选择"文件"->"另存为"，在编码处选择 "ANSI"，然后保存覆盖。
        2.  在命令提示符窗口标题栏右键 -> 属性 -> 字体，选择支持中文的字体（如 "新宋体"）。

--- 
